<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dunia Anak Sholeh - Arabika Smart Pro</title>
    <style>
        :root { --primary: #2d6a4f; --secondary: #95d5b2; --accent: #FF6FAE; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 15px; background: linear-gradient(to bottom, #4FC3F7, #6EE7B7); color: white; text-align: center; min-height: 100vh; }
        .section { background: white; color: #333; margin: 20px auto; padding: 20px; border-radius: 25px; max-width: 550px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .word-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; }
        .word { background: #FFD93D; padding: 10px 15px; border-radius: 15px; cursor: pointer; font-weight: bold; border: 2px solid #F4D03F; font-size: 13px; min-width: 80px; }
        button { background: var(--accent); border: none; padding: 12px 20px; margin: 8px; border-radius: 15px; color: white; cursor: pointer; font-weight: bold; transition: 0.3s; }
        button:hover { background: #FF4F81; }
        .avatar { width: 130px; height: 130px; margin: 20px auto; position: relative; }
        .hijab { width: 130px; height: 130px; background: radial-gradient(circle at 40% 30%, #FFB6D9, #FF6FAE); border-radius: 50%; position: absolute; }
        .face { width: 95px; height: 95px; background: #FFE0BD; border-radius: 50%; position: absolute; top: 20px; left: 17px; }
        .eye { width: 14px; height: 14px; background: black; border-radius: 50%; position: absolute; top: 45px; }
        .eye.left { left: 30px; } .eye.right { right: 30px; }
        .mouth { width: 35px; height: 15px; background: #FF4F81; border-radius: 0 0 35px 35px; position: absolute; bottom: 35px; left: 47px; transition: 0.2s; }
        .talk { height: 25px !important; border-radius: 50% !important; }
        #output-container { background: #f1f8e9; border-radius: 15px; padding: 15px; margin: 15px 0; border: 2px solid var(--secondary); }
        #output-text { font-size: 20px; color: var(--primary); font-weight: bold; direction: rtl; }
        .mic-btn { background: var(--primary); width: 80px; height: 80px; border-radius: 50%; font-size: 35px; margin: 10px auto; display: flex; align-items: center; justify-content: center; border:none; color:white; cursor:pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.2);}
        .listening { background: #e63946; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(230, 57, 70, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(230, 57, 70, 0); } 100% { box-shadow: 0 0 0 0 rgba(230, 57, 70, 0); } }
        .menu-dialog { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left; font-size: 11px; margin-top: 10px; max-height: 200px; overflow-y: auto; padding-right: 5px; }
        .dialog-item { background: #f9f9f9; padding: 8px; border-radius: 10px; border-left: 4px solid var(--primary); cursor: pointer; color: #333; }
        .mode-btn { padding: 8px 12px; border-radius: 15px; border: 2px solid var(--primary); background: white; color: var(--primary); cursor: pointer; font-size: 12px; font-weight: bold; }
        .mode-btn.active { background: var(--primary); color: white; }
    </style>
</head>
<body>

<audio id="bgMusic" loop>
    <source src="https://actions.google.com/sounds/v1/ambiences/children_playing.ogg" type="audio/ogg">
</audio>

<div style="font-size:26px; font-weight:bold; margin-top:10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);">üåô Dunia Anak Sholeh</div>
<div id="levelBox" style="margin:10px; font-weight:bold; background: white; color: var(--accent); display: inline-block; padding: 5px 15px; border-radius: 20px;">‚≠ê 0 | üèÜ Level 1</div>

<div class="avatar" onclick="speak('ÿ£ŸáŸÑÿßŸã Ÿàÿ≥ŸáŸÑÿßŸã Ÿäÿß ÿ£ÿµÿØŸÇÿßÿ°')">
    <div class="hijab"></div>
    <div class="face">
        <div class="eye left"></div>
        <div class="eye right"></div>
        <div class="mouth" id="mouth"></div>
    </div>
</div>

<div class="section">
    <h3>üéôÔ∏è Tanya Jawab Suara</h3>
    <div class="word-grid" style="margin-bottom: 15px;">
        <button id="mode-ar" class="mode-btn active" onclick="setMode('ar-SA')">Bicara Arab</button>
        <button id="mode-id" class="mode-btn" onclick="setMode('id-ID')">Tebak Benda (Indo)</button>
    </div>
    <div id="output-container">
        <div id="output-text">...</div>
        <div id="translation-text" style="font-weight: 600; color: #555;">Ketuk mic & Tanya Almira</div>
        <div id="tip-text" style="font-size: 11px; color: #e67e22; margin-top: 5px;"></div>
    </div>
    <button id="start-mic" class="mic-btn" onclick="startRecognition()">üéôÔ∏è</button>
    
    <div style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px;">
        <p style="font-weight: bold; font-size: 14px; margin-bottom: 5px; color:#333;">üìú Daftar Percakapan (Klik):</p>
        <div class="menu-dialog" id="menu-dialog"></div>
    </div>
</div>

<div class="section">
    <h3>üçé Belajar Buah & Hewan</h3>
    <div class="word-grid" id="materi-list"></div>
    <div id="lock-status" style="font-size: 12px; color: #d9534f; margin-top: 10px;"></div>
</div>

<div class="section">
    <h3>üëß Kuis Pintar Almira</h3>
    <div id="quiz-area">
        <button onclick="startQuiz()">Mulai Kuis</button>
    </div>
    <div id="quiz-score" style="margin-top:10px; font-weight:bold; color:var(--accent);"></div>
</div>

<div class="section" style="background: #FFF9C4;">
    <h3>üîì Aktifkan Semua Fitur</h3>
    <input type="password" id="kode-premium" style="padding:10px; border-radius:10px; border:1px solid #ccc; width:60%;" placeholder="Kode: ANAKSOLEH2026">
    <button onclick="unlock()">Unlock</button>
</div>

<script>
const buahData=[["ÿ™ŸèŸÅŸëŸéÿßÿ≠Ÿå","Apel"],["ŸÖŸéŸàŸíÿ≤Ÿå","Pisang"],["ÿ®Ÿèÿ±Ÿíÿ™ŸèŸÇŸéÿßŸÑŸå","Jeruk"],["ÿπŸêŸÜŸéÿ®Ÿå","Anggur"],["ŸÅŸéÿ±ŸéÿßŸàŸêŸÑŸéÿ©Ÿå","Stroberi"],["ÿ®Ÿéÿ∑ŸëŸêŸäÿÆŸå","Semangka"],["ÿ£ŸéŸÜŸéÿßŸÜŸéÿßÿ≥Ÿå","Nanas"],["ŸÖŸéÿßŸÜŸíÿ¨Ÿéÿß","Mangga"],["ŸÉŸéÿ±Ÿéÿ≤Ÿå","Ceri"],["ÿÆŸéŸàŸíÿÆŸå","Persik"],["ŸÑŸéŸäŸíŸÖŸèŸàŸÜŸå","Lemon"],["ÿ±ŸèŸÖŸëŸéÿßŸÜŸå","Delima"],["ÿ¨ŸéŸàŸëŸéÿßŸÅŸéÿ©Ÿå","Jambu"],["ÿ™ŸéŸÖŸíÿ±Ÿå","Kurma"],["ŸÉŸèŸÖŸëŸéÿ´Ÿíÿ±ŸéŸâ","Pir"],["ÿ£ŸèŸÅŸèŸàŸÉŸéÿßÿØŸèŸà","Alpukat"],["ÿ™ŸêŸäŸÜŸå","Tin"],["ÿ≤Ÿéÿ®ŸêŸäÿ®Ÿå","Kismis"],["ÿ¨ŸèŸàÿ≤Ÿè ÿßŸÑŸíŸáŸêŸÜŸíÿØŸê","Kelapa"],["ÿ®Ÿéÿßÿ®ŸéÿßŸäŸéÿß","Pepaya"],["ŸÉŸêŸäŸàŸêŸä","Kiwi"],["ÿ≥ŸéŸÅŸéÿ±Ÿíÿ¨ŸéŸÑŸå","Quince"],["ÿ¨Ÿêÿ±ŸêŸäÿ®Ÿí ŸÅŸèÿ±ŸèŸàÿ™","Grapefruit"],["ŸÑŸêŸäÿ™Ÿíÿ¥ŸêŸä","Leci"],["ÿ™ŸéŸÖŸéÿ±Ÿí ŸáŸêŸÜŸíÿØŸêŸä","Asam"]];
const hewanData=[["ŸÇŸêÿ∑ŸëŸå","Kucing"],["ŸÉŸéŸÑŸíÿ®Ÿå","Anjing"],["ÿ£Ÿéÿ±ŸíŸÜŸéÿ®Ÿå","Kelinci"],["ŸÅŸêŸäŸÑŸå","Gajah"],["ÿ£Ÿéÿ≥ŸéÿØŸå","Singa"],["ÿ®ŸéŸÇŸéÿ±Ÿéÿ©Ÿå","Sapi"],["ÿ≠ŸêÿµŸéÿßŸÜŸå","Kuda"],["ÿØŸéÿ¨Ÿéÿßÿ¨Ÿéÿ©Ÿå","Ayam"],["ÿ≥ŸéŸÖŸéŸÉŸéÿ©Ÿå","Ikan"],["ÿ∑Ÿéÿßÿ¶Ÿêÿ±Ÿå","Burung"],["ŸÇŸêÿ±ŸíÿØŸå","Monyet"],["ŸÜŸéŸÖŸêÿ±Ÿå","Harimau"],["ÿ≤Ÿéÿ±ŸéÿßŸÅŸéÿ©Ÿå","Jerapah"],["ÿ∞Ÿêÿ¶Ÿíÿ®Ÿå","Serigala"],["ÿØŸèÿ®ŸëŸå","Beruang"],["ÿ¨ŸéŸÖŸéŸÑŸå","Unta"],["ÿ∫ŸéŸÜŸéŸÖŸå","Kambing"],["ÿ≠ŸêŸÖŸéÿßÿ±Ÿå","Keledai"],["ŸÅŸéÿ£Ÿíÿ±Ÿå","Tikus"],["ÿ´ŸèÿπŸíÿ®ŸéÿßŸÜŸå","Ular"],["ÿ≥ŸèŸÑŸéÿ≠ŸíŸÅŸéÿßÿ©Ÿå","Kura-kura"],["ÿ∂ŸêŸÅŸíÿØŸéÿπŸå","Katak"],["ŸÜŸéÿ≠ŸíŸÑŸéÿ©Ÿå","Lebah"],["ÿ®Ÿéÿ∑ŸëŸéÿ©Ÿå","Bebek"],["ÿ≠ŸèŸàÿ™Ÿå","Paus"]];

const dialogDB = {
    "ÿßÿ≥ŸÖŸÉ": { q: "MƒÅ ismuka?", a: "ÿßÿ≥ŸíŸÖŸêŸä ÿ£ŸéŸÑŸíŸÖŸêŸäÿ±Ÿéÿß", t: "Nama saya Almira", tip: "Makhraj Alif tajam." },
    "ÿ£ŸäŸÜ ÿ£ŸÜÿ™": { q: "Min aina anta?", a: "ÿ£ŸéŸÜŸéÿß ŸÖŸêŸÜŸí ÿ•ŸêŸÜŸíÿØŸèŸàŸÜŸêŸäÿ≥ŸêŸäŸéÿß", t: "Saya dari Indonesia", tip: "Huruf Nun sukun jelas." },
    "ÿ≠ÿßŸÑ": { q: "Kaifa hƒÅluka?", a: "ÿ£ŸéŸÜŸéÿß ÿ®ŸêÿÆŸéŸäŸíÿ±Ÿç ŸàŸéÿßŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸÑŸêŸÑŸëŸéŸá", t: "Saya baik, Alhamdulillah", tip: "Ha bersih." },
    "ÿ™ÿ≥ŸÉŸÜ": { q: "Aina taskunu?", a: "ÿ£Ÿéÿ≥ŸíŸÉŸèŸÜŸè ŸÅŸêŸä ÿ¨ŸéÿßŸÉŸéÿ±Ÿíÿ™Ÿéÿß", t: "Saya tinggal di Jakarta", tip: "Sin bersih." },
    "ÿπŸÖŸÑ": { q: "MƒÅ ‚Äòamaluka?", a: "ÿ£ŸéŸÜŸéÿß ÿ∑ŸéÿßŸÑŸêÿ®Ÿéÿ©Ÿå ÿµŸéÿ∫ŸêŸäÿ±Ÿéÿ©", t: "Saya seorang pelajar", tip: "Ain ditekan." },
    "ÿπŸÖÿ±": { q: "Kam ‚Äòumruka?", a: "ÿπŸèŸÖŸíÿ±ŸêŸä ÿ™Ÿêÿ≥ŸíÿπŸè ÿ≥ŸéŸÜŸéŸàŸéÿßÿ™", t: "Umur saya 9 tahun", tip: "Ain jelas." },
    "ÿ™ÿ≠ÿ®": { q: "MƒÅdzƒÅ tuhibbu?", a: "ÿ£Ÿèÿ≠Ÿêÿ®ŸëŸè ÿßŸÑŸíŸÇŸêÿ±Ÿéÿßÿ°Ÿéÿ©Ÿé ŸàŸéÿßŸÑÿØŸëŸêÿ±Ÿéÿßÿ≥Ÿéÿ©", t: "Saya suka membaca", tip: "Ha bersih." },
    "ŸÖÿ≥ŸÑŸÖ": { q: "Hal anta muslim?", a: "ŸÜŸéÿπŸéŸÖŸíÿå ÿ£ŸéŸÜŸéÿß ŸÖŸèÿ≥ŸíŸÑŸêŸÖŸéÿ©Ÿå", t: "Ya, saya muslimah", tip: "Sin mendesis." },
    "ÿ™ÿ≥ÿ™ŸäŸÇÿ∏": { q: "MatƒÅ tastaiqizhu?", a: "ÿ£Ÿéÿ≥Ÿíÿ™ŸéŸäŸíŸÇŸêÿ∏Ÿè ÿµŸéÿ®Ÿéÿßÿ≠Ÿãÿß ÿ®ŸéÿßŸÉŸêÿ±Ÿãÿß", t: "Saya bangun pagi", tip: "Zho tebal." },
    "ÿ£ÿ®ŸàŸÉ": { q: "Aina ab≈´ka?", a: "ÿ£Ÿéÿ®ŸêŸä ŸÅŸêŸä ÿßŸÑŸíÿ®ŸéŸäŸíÿ™Ÿê ÿßŸÑÿ¢ŸÜ", t: "Ayah saya di rumah", tip: "Ba mantap." },
    "kucing": { ar: "ŸÇŸêÿ∑ŸëŸå", tip: "Qof tebal." },
    "anjing": { ar: "ŸÉŸéŸÑŸíÿ®Ÿå", tip: "Kaf tipis." },
    "apel": { ar: "ÿ™ŸèŸÅŸëŸéÿßÿ≠Ÿå", tip: "Ha bersih." },
    "pisang": { ar: "ŸÖŸéŸàŸíÿ≤Ÿå", tip: "Zai bergetar." }
};

let premium = localStorage.getItem("premium") === "true";
let level = parseInt(localStorage.getItem("level")) || 1;
let stars = parseInt(localStorage.getItem("stars")) || 0;
let currentMode = 'ar-SA';

const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

function setMode(mode) {
    currentMode = mode;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(mode === 'ar-SA' ? 'mode-ar' : 'mode-id').classList.add('active');
}

function startRecognition() {
    recognition.lang = currentMode;
    recognition.start();
    document.getElementById('start-mic').classList.add('listening');
    document.getElementById('bgMusic').play().catch(e=>{});
}

recognition.onresult = (event) => {
    const speech = event.results[0][0].transcript.toLowerCase();
    document.getElementById('output-text').innerText = speech;
    document.getElementById('start-mic').classList.remove('listening');
    
    let found = false;
    for (let key in dialogDB) {
        if (speech.includes(key.toLowerCase())) {
            const data = dialogDB[key];
            if(currentMode === 'id-ID') {
                document.getElementById('output-text').innerText = data.ar;
                speak(data.ar);
            } else {
                document.getElementById('translation-text').innerText = data.t;
                speak(data.a);
            }
            document.getElementById('tip-text').innerText = "üí° Tips: " + data.tip;
            found = true; stars++; checkLevelUp(); break;
        }
    }
    if(!found) document.getElementById('translation-text').innerText = "Maaf, coba lagi ya.";
};

function speak(text){
    window.speechSynthesis.cancel();
    let u = new SpeechSynthesisUtterance(text);
    u.lang = "ar-SA"; u.rate = 0.8;
    document.getElementById("mouth").classList.add("talk");
    u.onend = () => document.getElementById("mouth").classList.remove("talk");
    window.speechSynthesis.speak(u);
}

function renderMateri(){
    let html = "";
    let limit = premium ? 25 : (level * 5);
    if(limit > 25) limit = 25;
    for(let i=0; i<limit; i++){
        html += `<div class="word" onclick="speak('${buahData[i][0]}')">${buahData[i][0]}<br><small>${buahData[i][1]}</small></div>`;
        html += `<div class="word" onclick="speak('${hewanData[i][0]}')">${hewanData[i][0]}<br><small>${hewanData[i][1]}</small></div>`;
    }
    document.getElementById("materi-list").innerHTML = html;
    document.getElementById("lock-status").innerText = premium ? "‚úÖ Semua Terbuka" : `üîí Level ${level}: ${limit*2}/50 Materi Terbuka.`;
}

let qData = [...buahData, ...hewanData], currentQ=0, qScore=0, activeQs=[];
function startQuiz(){
    activeQs = [...qData].sort(()=>Math.random()-0.5).slice(0, 5);
    currentQ = 0; qScore = 0; showQuestion();
}

function showQuestion(){
    if(currentQ >= activeQs.length){
        document.getElementById('quiz-area').innerHTML = `<button onclick="startQuiz()">Ulangi Kuis</button>`;
        document.getElementById('quiz-score').innerText = `Skor: ${qScore}/5`;
        if(qScore === 5) { stars += 5; checkLevelUp(); }
        return;
    }
    let q = activeQs[currentQ];
    speak(q[0]);
    let opts = [q[1]];
    while(opts.length < 4){
        let r = qData[Math.floor(Math.random()*qData.length)][1];
        if(!opts.includes(r)) opts.push(r);
    }
    opts.sort(()=>Math.random()-0.5);
    let h = `<h4>Apa arti dari: ${q[0]}?</h4>`;
    opts.forEach(o => h += `<button onclick="checkAns(this, '${o}', '${q[1]}')">${o}</button>`);
    document.getElementById('quiz-area').innerHTML = h;
}

function checkAns(btn, sel, cor){
    if(sel === cor) { btn.style.background="#4CAF50"; qScore++; }
    else btn.style.background="#F44336";
    currentQ++; setTimeout(showQuestion, 1000);
}

function checkLevelUp(){
    if(stars >= 10){ level++; stars = 0; alert("Naik Level " + level); renderMateri(); }
    localStorage.setItem("stars", stars); localStorage.setItem("level", level);
    document.getElementById("levelBox").innerText = `‚≠ê ${stars} | üèÜ Level ${level}`;
}

function unlock(){
    if(document.getElementById("kode-premium").value === "ANAKSOLEH2026"){
        premium = true; localStorage.setItem("premium", "true"); renderMateri();
    }
}

// RENDER DIALOG MENU
let menuHtml = "";
for (let key in dialogDB) {
    if(dialogDB[key].q) menuHtml += `<div class="dialog-item" onclick="speak('${dialogDB[key].a}');"><strong>${dialogDB[key].q}</strong><br>${dialogDB[key].a}</div>`;
}
document.getElementById('menu-dialog').innerHTML = menuHtml;

renderMateri();
</script>
</body>
</html>
